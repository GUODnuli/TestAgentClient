# 贷款利率计算接口测试计划

## 1. 测试概述

### 1.1 测试目标
本测试计划旨在验证贷款利率计算接口的正确性、健壮性和可靠性，确保接口能够：
- 正确处理所有有效的业务场景
- 准确应用兜底机制（当计算利率低于2.0%时返回2.0%）
- 有效处理异常输入和错误情况
- 提供一致且符合业务规范的响应

### 1.2 接口基本信息
- **接口地址**: http://127.0.0.1:5000/calculate_rate
- **请求方法**: POST
- **请求头**: Content-Type: application/json

## 2. 业务规则分析

### 2.1 核心业务参数
- **贷款期限**: "12"（12个月）、"24"（24个月）、"36"（36个月）
- **还款方式**: "equal_principal_interest"（等额本息）、"month_inter_pay"（按月付息按计划还本）
- **优惠券选项**: 0（不使用）、20（2折优惠）

### 2.2 利率计算规则
- **基础利率**: 8.64%
- **优惠券2折后利率**: 8.64% × 0.2 = 1.728%
- **兜底利率**: 2.0%（当计算结果低于2.0%时触发）

## 3. 测试用例设计

### 3.1 正向测试用例（9个）

#### 3.1.1 不使用优惠券（use_coupon = 0）
| 用例编号 | 贷款期限 | 还款方式 | 预期结果 |
|---------|---------|---------|---------|
| TC01 | "12" | "equal_principal_interest" | {"rate": 8.64} |
| TC02 | "12" | "month_inter_pay" | {"rate": 8.64} |
| TC03 | "24" | "equal_principal_interest" | {"rate": 8.64} |
| TC04 | "24" | "month_inter_pay" | {"rate": 8.64} |
| TC05 | "36" | "equal_principal_interest" | {"rate": 8.64} |
| TC06 | "36" | "month_inter_pay" | {"rate": 8.64} |

#### 3.1.2 使用优惠券（use_coupon = 20）
| 用例编号 | 贷款期限 | 还款方式 | 预期结果 |
|---------|---------|---------|---------|
| TC07 | "12" | "equal_principal_interest" | {"rate": 2.0} |
| TC08 | "24" | "month_inter_pay" | {"rate": 2.0} |
| TC09 | "36" | "equal_principal_interest" | {"rate": 2.0} |

### 3.2 异常测试用例（15+个）

#### 3.2.1 无效贷款期限
- TC10: term="6"（不支持的期限）
- TC11: term="48"（超出范围）
- TC12: term=""（空字符串）

#### 3.2.2 无效还款方式
- TC13: repayment_method="equal_principal"（不存在的方式）
- TC14: repayment_method=""（空字符串）
- TC15: repayment_method="other_method"（非法值）

#### 3.2.3 无效优惠券参数
- TC16: use_coupon=10（不支持的折扣）
- TC17: use_coupon=-1（负数）
- TC18: use_coupon=100（超出范围）

#### 3.2.4 缺失必填字段
- TC19: 缺少term字段
- TC20: 缺少repayment_method字段
- TC21: 缺少use_coupon字段
- TC22: 空请求体

#### 3.2.5 数据类型错误
- TC23: term=12（数字而非字符串）
- TC24: repayment_method=1（数字而非字符串）
- TC25: use_coupon="20"（字符串而非整数）

#### 3.2.6 边界值测试
- TC26: term="12 "（尾部空格）
- TC27: term=" 12"（前导空格）

## 4. 测试执行策略

### 4.1 测试环境要求
- **测试服务器**: http://127.0.0.1:5000
- **网络要求**: 确保测试机器能访问本地5000端口
- **工具要求**: Postman、curl或自动化测试框架

### 4.2 执行优先级
1. **高优先级**: 正向测试用例（TC01-TC09）
   - 验证核心业务功能
   - 验证兜底机制正确性
2. **中优先级**: 异常测试用例（TC10-TC27）
   - 验证参数验证机制
   - 验证错误处理能力

### 4.3 执行方法
- 每个测试用例独立执行
- 记录详细的请求/响应数据
- 验证HTTP状态码和响应内容
- 记录响应时间性能指标

## 5. 验收标准

### 5.1 功能验收标准
- 所有正向测试用例必须返回预期的正确利率值
- 兜底机制必须在计算结果低于2.0%时正确触发
- 所有异常测试用例必须返回适当的错误响应

### 5.2 性能验收标准
- 接口响应时间应小于1秒
- 系统资源使用应在合理范围内

### 5.3 可靠性验收标准
- 接口在连续调用下保持稳定
- 错误情况下不会导致系统崩溃

## 6. 风险控制

### 6.1 测试前准备
- 确认接口服务已正常启动
- 准备完整的测试数据集
- 备份当前系统状态（如需要）

### 6.2 测试过程监控
- 实时监控系统资源使用情况
- 记录详细的测试日志
- 准备应急回滚方案

### 6.3 测试后验证
- 验证系统状态正常
- 清理测试产生的临时数据
- 生成完整的测试报告

## 7. 附录

### 7.1 测试数据模板
```json
{
  "term": "12",
  "repayment_method": "equal_principal_interest", 
  "use_coupon": 0
}
```

### 7.2 成功响应示例
```json
{"rate": 8.64}
```

### 7.3 预期错误响应格式
- HTTP状态码：400（Bad Request）或其他适当的错误码
- 响应体：包含错误描述信息